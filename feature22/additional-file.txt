Improve the functionality of feature22 branch
